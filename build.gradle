plugins {
	id("fabric-loom") version "0.10.+"
	id("maven-publish")
}

version = "1.0.0"
group = "shateq.mods"
archivesBaseName = "lens-fabric-${project.minecraft}-${project.version}"

repositories {
	mavenCentral()
}

dependencies {
	minecraft("com.mojang:minecraft:${project.mc}")
	mappings(loom.officialMojangMappings())
	modImplementation("net.fabricmc:fabric-loader:${project.loader}")

	modImplementation("net.fabricmc.fabric-api:fabric-api:${project.fabric}")
}

java {
	toolchain.languageVersion.set(JavaLanguageVersion.of(17))
//	withSourcesJar()
}

tasks {
	compileJava {
		options.encoding = "UTF-8" // Must have!
		options.release.set(17) // Java 17 for 1.18+
	}

	processResources {
		filteringCharset = "UTF-8" // Must have!

		inputs.property("version", project.version)
		filesMatching("fabric.mod.json") {
			expand(
					"version": project.version
			)
		}
	}

	jar {
		from("LICENSE") {
			rename { "LICENSE_${project.archivesBaseName}"}
		}
	}
}

loom {
	mixin.defaultRefmapName = "lens.refmap.json"
}